#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс

Функция СформироватьСписокЛистов(Объект) Экспорт
	Если Объект.ИмяФормы = "Форма2017_1" Тогда 
		Возврат СформироватьСписокЛистовФорма2017_1(Объект);
	ИначеЕсли Объект.ИмяФормы = "Форма2022_1" Тогда 
		Возврат СформироватьСписокЛистовФорма2022_1(Объект);
	ИначеЕсли Объект.ИмяФормы = "Форма2023_1" Тогда 
		Возврат СформироватьСписокЛистовФорма2023_1(Объект);
	КонецЕсли;
КонецФункции

Функция ДействующаяРедакцияФормы(Дата) Экспорт
	Возврат "Форма2023_1";
КонецФункции

#КонецОбласти

#Область СлужебныеПроцедурыИФункции
Функция ПолучитьТаблицуПримененияФорматов() Экспорт 
	Результат = Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюТаблицуПримененияФорматов();
	
	Стр = Результат.Добавить();
	Стр.ИмяФормы = "Форма2017_1";
	Стр.КНД = "1110058";
	Стр.ВерсияФормата = "5.01";
	
	Стр = Результат.Добавить();
	Стр.ИмяФормы = "Форма2022_1";
	Стр.КНД = "1110058";
	Стр.ВерсияФормата = "5.02";
	
	Стр = Результат.Добавить();
	Стр.ИмяФормы = "Форма2023_1";
	Стр.КНД = "1110058";
	Стр.ВерсияФормата = "5.03";
	
	Возврат Результат;
КонецФункции

Функция ДанноеУведомлениеДоступноДляОрганизации() Экспорт 
	Возврат Истина;
КонецФункции

Функция ДанноеУведомлениеДоступноДляИП() Экспорт 
	Возврат Истина;
КонецФункции

Функция ПолучитьОсновнуюФорму() Экспорт 
	Возврат "";
КонецФункции

Функция ПолучитьФормуПоУмолчанию() Экспорт 
	Возврат "";
КонецФункции

Функция ПолучитьТаблицуФорм() Экспорт 
	Результат = Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюТаблицуФормУведомления();
	
	Стр = Результат.Добавить();
	Стр.ИмяФормы = "Форма2023_1";
	Стр.ОписаниеФормы = "В соответствии с приказом ФНС России от 14.11.2022 № ЕД-7-19/1085@ в формате 5.03";
	Стр.ДатаНачала = Дата('20221213');
	Стр.ДатаКонца = Дата('20991231');
	
	Возврат Результат;
КонецФункции

Функция ЭлектронноеПредставление(Объект, ИмяФормы, УникальныйИдентификатор) Экспорт
	Если ИмяФормы = "Форма2017_1" Тогда
		Возврат ЭлектронноеПредставление_Форма2017_1(Объект, УникальныйИдентификатор);
	ИначеЕсли ИмяФормы = "Форма2022_1" Тогда
		Возврат ЭлектронноеПредставление_Форма2022_1(Объект, УникальныйИдентификатор);
	ИначеЕсли ИмяФормы = "Форма2023_1" Тогда
		Возврат ЭлектронноеПредставление_Форма2023_1(Объект, УникальныйИдентификатор);
	КонецЕсли;
	Возврат Неопределено;
КонецФункции

Функция ПроверитьДокумент(Объект, ИмяФормы, УникальныйИдентификатор) Экспорт
	Если ИмяФормы = "Форма2017_1" Тогда
		Попытка
			Данные = Объект.ДанныеУведомления.Получить();
			Проверить_Форма2017_1(Данные, УникальныйИдентификатор);
			РегламентированнаяОтчетность.СообщитьПользователюОбОшибкеВУведомлении("Проверка уведомления прошла успешно.", УникальныйИдентификатор);
		Исключение
			РегламентированнаяОтчетность.СообщитьПользователюОбОшибкеВУведомлении("При проверке уведомления обнаружены ошибки.", УникальныйИдентификатор);
		КонецПопытки;
	КонецЕсли;
КонецФункции

Функция ПроверитьДокументСВыводомВТаблицу(Объект, ИмяФормы, УникальныйИдентификатор) Экспорт 
	Если ИмяФормы = "Форма2017_1" Тогда 
		Возврат ПроверитьДокументСВыводомВТаблицу_Форма2017_1(
			Объект, УведомлениеОСпецрежимахНалогообложения.ДанныеУведомленияДляВыгрузки(Объект), УникальныйИдентификатор);
	ИначеЕсли ИмяФормы = "Форма2022_1" Тогда 
		Возврат ПроверитьДокументСВыводомВТаблицу_Форма2022_1(
			Объект, УведомлениеОСпецрежимахНалогообложения.ДанныеУведомленияДляВыгрузки(Объект), УникальныйИдентификатор);
	ИначеЕсли ИмяФормы = "Форма2023_1" Тогда 
		Возврат ПроверитьДокументСВыводомВТаблицу_Форма2023_1(
			Объект, УведомлениеОСпецрежимахНалогообложения.ДанныеУведомленияДляВыгрузки(Объект), УникальныйИдентификатор);
	КонецЕсли;
КонецФункции

Функция ИдентификаторФайлаЭлектронногоПредставления_Форма2017_1(СведенияОтправки)
	Префикс = "IU_SOGNTOB";
	Возврат Документы.УведомлениеОСпецрежимахНалогообложения.ИдентификаторФайлаЭлектронногоПредставления(Префикс, СведенияОтправки);
КонецФункции

Функция ПроверитьДокументСВыводомВТаблицу_Форма2017_1(Объект, Данные, УникальныйИдентификатор)
	ТаблицаОшибок = Новый СписокЗначений;
	ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
		"Формат 5.01 устарел", "Титульная"));
	Возврат ТаблицаОшибок;
КонецФункции

Функция ПроверитьДокументСВыводомВТаблицу_Форма2022_1(Объект, Данные, УникальныйИдентификатор)
	ТаблицаОшибок = Новый СписокЗначений;
	ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
		"Формат 5.02 устарел", "Титульная"));
	Возврат ТаблицаОшибок;
КонецФункции

Функция ПроверитьДокументСВыводомВТаблицу_Форма2023_1(Объект, Данные, УникальныйИдентификатор)
	ТаблицаОшибок = Новый СписокЗначений;
	УведомлениеОСпецрежимахНалогообложения.ПроверкаАктуальностиФормыПриВыгрузке(
		Данные.Объект.ИмяФормы, ТаблицаОшибок, ПолучитьТаблицуФорм());
	
	Титульная = Данные.ДанныеУведомления.Титульная;
	Лист001 = Данные.ДанныеУведомления.Лист001;
	Лист002 = Данные.ДанныеУведомления.Лист002;
	Если РегламентированнаяОтчетностьПереопределяемый.ЭтоЮридическоеЛицо(Данные.Организация) Тогда 
		УведомлениеОСпецрежимахНалогообложения.ПроверкаИННКПП(Истина, Титульная, ТаблицаОшибок);
	ИначеЕсли Титульная.ПризНП = "1" Тогда 
		УведомлениеОСпецрежимахНалогообложения.ПроверкаИННКПП(Ложь, Титульная, ТаблицаОшибок);
	ИначеЕсли Титульная.ПризНП = "2" Тогда
		Если Не ЗначениеЗаполнено(Титульная.КодВидДок) Тогда 
			ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
				"Не указан код документа", "Титульная", "КодВидДок"));
		КонецЕсли;
		Если Не ЗначениеЗаполнено(Титульная.СерНомДок) Тогда 
			ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
				"Не указана серия и номер документа", "Титульная", "СерНомДок"));
		КонецЕсли;
		Если Не ЗначениеЗаполнено(Титульная.ДатаДок) Тогда 
			ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
				"Не указана дата выдачи документа", "Титульная", "ДатаДок"));
		КонецЕсли;
		УведомлениеОСпецрежимахНалогообложения.ПроверкаИНН(Титульная, ТаблицаОшибок, "Титульная", "ИНН", Ложь, Ложь);
	Иначе
		ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
			"Не указан / неправильно указан признак налогоплательщика", "Титульная", "ПризНП"));
	КонецЕсли;
	
	Если ЗначениеЗаполнено(Титульная.ИмФайлСогл) И ЗначениеЗаполнено(Титульная.РегНомСогл) Тогда 
		ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
			"Необходимо заполнить либо имя файла согласия, либо номер на бумажном носителе", "Титульная", "ИмФайлСогл"));
	ИначеЕсли Титульная.ПризДок = "2" 
		И Не ЗначениеЗаполнено(Титульная.ИмФайлСогл) 
		И Не ЗначениеЗаполнено(Титульная.РегНомСогл) Тогда 
		
		ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
			"Не указаны сведения о выданном ранее согласии", "Титульная", "ИмФайлСогл"));
	КонецЕсли;
	
	Если (Титульная.ПризДок = "1" И Данные.ОТЧ.ПривестиЗначение(Титульная.ДатаНачПер) < 1900)
		Или (Данные.ОТЧ.ПривестиЗначение(Титульная.ДатаНачПер) > 0 И Данные.ОТЧ.ПривестиЗначение(Титульная.ДатаНачПер) < 1900) Тогда 
		
		ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
			"Не указан / неправильно указан год начала раскрытия показателей", "Титульная", "ДатаНачПер"));
	КонецЕсли;
	Если (Данные.ОТЧ.ПривестиЗначение(Титульная.ДатаКонПер) > 0 И Данные.ОТЧ.ПривестиЗначение(Титульная.ДатаКонПер) < 1900) Тогда 
		
		ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
			"Неправильно указан год окончания раскрытия показателей", "Титульная", "ДатаКонПер"));
	КонецЕсли;
	
	УведомлениеОСпецрежимахНалогообложения.ПроверкаКодаНО(Титульная.КодНО, ТаблицаОшибок, "Титульная");
	Если Не ЗначениеЗаполнено(Титульная.НаимОрг) Тогда 
		ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
			"Не указано наименование организации", "Титульная", "НаимОрг"));
	КонецЕсли;
	Если Не ЗначениеЗаполнено(Титульная.ПРИЗНАК_НП_ПОДВАЛ) Тогда 
		ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
			"Не указан признак подписанта", "Титульная", "ПРИЗНАК_НП_ПОДВАЛ"));
	КонецЕсли;
	Если Не ЗначениеЗаполнено(Титульная.ПризДок) Тогда 
		ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
			"Не указан признак документа", "Титульная", "ПризДок"));
	КонецЕсли;
	Если Не ЗначениеЗаполнено(Титульная.ПризРаскрСвед) И Титульная.ПризДок = "1" Тогда 
		ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
			"Не указан признак раскрытия сведений", "Титульная", "ПризРаскрСвед"));
	КонецЕсли;
	Если Не ЗначениеЗаполнено(Титульная.ДАТА_ПОДПИСИ) Тогда 
		ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
			"Не указана дата подписи", "Титульная", "ДАТА_ПОДПИСИ"));
	КонецЕсли;
	УведомлениеОСпецрежимахНалогообложения.ПроверкаПодписантаНалоговойОтчетности(
		Данные, ТаблицаОшибок, "Титульная", 
		Титульная.ПРИЗНАК_НП_ПОДВАЛ = "2" Или РегламентированнаяОтчетностьПереопределяемый.ЭтоЮридическоеЛицо(Объект.Организация));
	Если Титульная.ПРИЗНАК_НП_ПОДВАЛ = "2" И Не ЗначениеЗаполнено(Титульная.НаимДок) Тогда 
		ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
			"Не указан документ представителя", "Титульная", "НаимДок"));
	КонецЕсли;
	
	Если ЗначениеЗаполнено(Дата(Титульная.ДатаНачСогл)) 
		И НачалоДня(Дата(Титульная.ДатаНачСогл)) < НачалоДня(ТекущаяДатаСеанса()) Тогда 
		ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
			"Начало действия согласия не должно быть в прошлом", "Титульная", "ДатаНачСогл"));
	КонецЕсли;
	
	Если Титульная.ПризРаскрСвед = "1" Тогда 
		Заполненность = ЗначениеЗаполнено(Лист001.КодКомпл);
		Для Каждого Стр Из Данные.ДанныеДопСтрокБД.МнгСтр1 Цикл
			Если Заполненность Тогда 
				Прервать;
			КонецЕсли;
			Заполненность = Заполненность Или ЗначениеЗаполнено(Стр.КодСвед);
		КонецЦикла;
		
		Если Титульная.ПризДок = "1" И Не Заполненность Тогда 
			ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
				"Не заполнен лист с кодами", "Лист001", "КодКомпл"));
		КонецЕсли;
		
		Если ЗначениеЗаполнено(Лист001.КодКомпл) Тогда 
			ЗаполненностьМнгСтр = Ложь;
			Для Каждого Стр Из Данные.ДанныеДопСтрокБД.МнгСтр1 Цикл 
				ЗаполненностьМнгСтр = ЗаполненностьМнгСтр Или ЗначениеЗаполнено(Стр.КодСвед);
			КонецЦикла;
			Если ЗаполненностьМнгСтр Тогда 
				ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
					"Указывается или код комплекта или коды сведений", "Лист001", "КодКомпл"));
			КонецЕсли;
		КонецЕсли;
	ИначеЕсли Титульная.ПризРаскрСвед = "2" Тогда
		Если ЗначениеЗаполнено(Лист002.КодКомпл) Тогда 
			ЗаполненностьМнгСтр = Ложь;
			Для Каждого Стр Из Данные.ДанныеДопСтрокБД.МнгСтр2 Цикл 
				ЗаполненностьМнгСтр = ЗаполненностьМнгСтр Или ЗначениеЗаполнено(Стр.КодСвед);
			КонецЦикла;
			Если ЗаполненностьМнгСтр Тогда 
				ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
					"Указывается или код комплекта или коды сведений", "Лист002", "КодКомпл"));
			КонецЕсли;
		КонецЕсли;
		Если УведомлениеОСпецрежимахНалогообложения.БлокЗаполнен(Титульная, "ПрПодп,ФамилияПред,ИмяПред,ОтчествоПред,ТлфПред,НаимДокПред") Тогда 
			Если Не ЗначениеЗаполнено(Титульная.ПрПодп) Тогда 
				ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
					"Не указан признак подписанта", "Титульная", "ПрПодп"));
			КонецЕсли;
			Если Не ЗначениеЗаполнено(Титульная.ФамилияПред) Тогда 
				ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
					"Не указана фамилия подписанта", "Титульная", "ФамилияПред"));
			КонецЕсли;
			Если Не ЗначениеЗаполнено(Титульная.ИмяПред) Тогда 
				ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
					"Не указано имя подписанта", "Титульная", "ИмяПред"));
			КонецЕсли;
			Если Титульная.ПрПодп = "2" И Не ЗначениеЗаполнено(Титульная.НаимДокПред) Тогда
				ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
					"Не указан документ подписанта", "Титульная", "НаимДокПред"));
			КонецЕсли;
		КонецЕсли;
		
		Если ЗначениеЗаполнено(Лист002.ИННЮЛ) Или ЗначениеЗаполнено(Лист002.НаимОрг) Тогда
			УведомлениеОСпецрежимахНалогообложения.ПроверкаИНН(Лист002, ТаблицаОшибок, "Лист002", "ИННЮЛ", Истина, Истина);
			Если Не ЗначениеЗаполнено(Лист002.НаимОрг) Тогда 
				ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
					"Не заполнено наименование организации", "Лист002", "НаимОрг"));
			КонецЕсли;
			Если УведомлениеОСпецрежимахНалогообложения.БлокЗаполнен(Лист002, "ПризНП,ИННФЛ,Фамилия,Имя,Отчество,КодВидДок,СерНомДок,ДатаДок") Тогда
				ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
					"При заполненной организации сведения о физлице не заполняются", "Лист002", "ПризНП"));
			КонецЕсли;
		ИначеЕсли УведомлениеОСпецрежимахНалогообложения.БлокЗаполнен(Лист002, "ПризНП,ИННФЛ,Фамилия,Имя,Отчество,КодВидДок,СерНомДок,ДатаДок") Тогда
			Если Не ЗначениеЗаполнено(Лист002.ПризНП) Тогда 
				ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
					"Не заполнен признак", "Лист002", "ПризНП"));
			КонецЕсли;
			Если Не ЗначениеЗаполнено(Лист002.Фамилия) Тогда 
				ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
					"Не заполнена фамилия", "Лист002", "Фамилия"));
			КонецЕсли;
			Если Не ЗначениеЗаполнено(Лист002.Имя) Тогда 
				ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
					"Не заполнено имя", "Лист002", "Имя"));
			КонецЕсли;
			УведомлениеОСпецрежимахНалогообложения.ПроверкаИНН(Лист002, ТаблицаОшибок, "Лист002", "ИННФЛ", (Лист002.ПризНП = "1"), Ложь);
			
			Если Не ЗначениеЗаполнено(Лист002.ИННФЛ) 
				Или УведомлениеОСпецрежимахНалогообложения.БлокЗаполнен(Лист002, "КодВидДок,СерНомДок,ДатаДок") Тогда 
				
				Если Не ЗначениеЗаполнено(Лист002.КодВидДок) Тогда 
					ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
						"Не заполнен код документа", "Лист002", "КодВидДок"));
				КонецЕсли;
				Если Не ЗначениеЗаполнено(Лист002.СерНомДок) Тогда 
					ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
						"Не заполнены серия и номер документа", "Лист002", "СерНомДок"));
				КонецЕсли;
				Если Не ЗначениеЗаполнено(Лист002.ДатаДок) Тогда 
					ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
						"Не заполнена дата выдачи документа", "Лист002", "ДатаДок"));
				КонецЕсли;
			КонецЕсли;
		Иначе
			ТаблицаОшибок.Добавить(Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПустуюСтруктуруНавигацииПоОшибкам(
				"Не заполнены сведения, кому предоставляется доступ", "Лист002", "ИННЮЛ"));
		КонецЕсли;
	КонецЕсли;
	
	УведомлениеОСпецрежимахНалогообложения.ПроверкаДатВУведомлении(Данные, ТаблицаОшибок);
	УведомлениеОСпецрежимахНалогообложения.ПолнаяПроверкаЗаполненныхПоказателейНаСоотвествиеСписку(
		"СпискиВыбора2023_1", "СхемаВыгрузкиФорма2023_1", Данные.Объект.ИмяОтчета, ТаблицаОшибок, Данные);
	Возврат ТаблицаОшибок;
КонецФункции

Процедура Проверить_Форма2017_1(Данные, УникальныйИдентификатор)
КонецПроцедуры

Функция ОсновныеСведенияЭлектронногоПредставления_Форма2017_1(Объект, УникальныйИдентификатор)
	ОсновныеСведения = Документы.УведомлениеОСпецрежимахНалогообложения.НачальнаяИнициализацияОбщихРеквизитовВыгрузки(Объект);
	
	Данные = Объект.ДанныеУведомления.Получить();
	ОсновныеСведения.Вставить("ТекстСвед", Данные.ДанныеУведомления.Лист002.ТекстСвед);
	ОсновныеСведения.Вставить("ПризСвед", Данные.ДанныеУведомления.Титульная.ПризСвед);
	ИдентификаторФайла = ИдентификаторФайлаЭлектронногоПредставления_Форма2017_1(ОсновныеСведения);
	ОсновныеСведения.Вставить("ИдФайл", ИдентификаторФайла);
	
	Возврат ОсновныеСведения;
КонецФункции

Функция ЭлектронноеПредставление_Форма2017_1(Объект, УникальныйИдентификатор)
	СведенияЭлектронногоПредставления = УведомлениеОСпецрежимахНалогообложения.СведенияЭлектронногоПредставления();
	ДанныеУведомления = УведомлениеОСпецрежимахНалогообложения.ДанныеУведомленияДляВыгрузки(Объект);
	Ошибки = ПроверитьДокументСВыводомВТаблицу_Форма2017_1(Объект, ДанныеУведомления, УникальныйИдентификатор);
	УведомлениеОСпецрежимахНалогообложения.СообщитьОшибкиПриПроверкеВыгрузки(Объект, Ошибки, ДанныеУведомления);
	ОсновныеСведения = ОсновныеСведенияЭлектронногоПредставления_Форма2017_1(Объект, УникальныйИдентификатор);
	СтруктураВыгрузки = Документы.УведомлениеОСпецрежимахНалогообложения.ИзвлечьСтруктуруXMLУведомления(Объект.ИмяОтчета, "СхемаВыгрузкиФорма2017_1");
	ЗаполнитьДанными_Форма2017_1(Объект, ОсновныеСведения, СтруктураВыгрузки);
	УведомлениеОСпецрежимахНалогообложения.ВыгрузитьДеревоВТаблицу(СтруктураВыгрузки, ОсновныеСведения, СведенияЭлектронногоПредставления);
	Возврат СведенияЭлектронногоПредставления;
КонецФункции

Процедура ЗаполнитьДанными_Форма2022_1(Объект, Параметры, ДеревоВыгрузки)
	Документы.УведомлениеОСпецрежимахНалогообложения.ОбработатьУсловныеЭлементы(Параметры, ДеревоВыгрузки);
	Документы.УведомлениеОСпецрежимахНалогообложения.ЗаполнитьПараметрыСРазделами(Параметры, ДеревоВыгрузки);
	ДанныеУведомления = Объект.ДанныеУведомления.Получить();
	УведомлениеОСпецрежимахНалогообложения.ЗаполнитьДаннымиУзелНов(ДанныеУведомления, ДеревоВыгрузки);
	Документы.УведомлениеОСпецрежимахНалогообложения.ОтсечьНезаполненныеНеобязательныеУзлы(ДеревоВыгрузки);
КонецПроцедуры

Функция ОсновныеСведенияЭлектронногоПредставления_Форма2022_1(Объект, УникальныйИдентификатор)
	ОсновныеСведения = Документы.УведомлениеОСпецрежимахНалогообложения.НачальнаяИнициализацияОбщихРеквизитовВыгрузки(Объект);
	Данные = Объект.ДанныеУведомления.Получить();
	ОсновныеСведения.Вставить("ПризНП", Данные.ДанныеУведомления.Титульная.ПризНП);
	ОсновныеСведения.Вставить("ПризРаскрСвед", Данные.ДанныеУведомления.Титульная.ПризРаскрСвед);
	ОсновныеСведения.Вставить("ЮЛ_Лист002", 
		ЗначениеЗаполнено(Данные.ДанныеУведомления.Лист002.ИННЮЛ) Или ЗначениеЗаполнено(Данные.ДанныеУведомления.Лист002.НаимОрг));
	
	ИдентификаторФайла = ИдентификаторФайлаЭлектронногоПредставления_Форма2017_1(ОсновныеСведения);
	ОсновныеСведения.Вставить("ИдФайл", ИдентификаторФайла);
	Возврат ОсновныеСведения;
КонецФункции

Функция ЭлектронноеПредставление_Форма2022_1(Объект, УникальныйИдентификатор)
	СведенияЭлектронногоПредставления = УведомлениеОСпецрежимахНалогообложения.СведенияЭлектронногоПредставления();
	ДанныеУведомления = УведомлениеОСпецрежимахНалогообложения.ДанныеУведомленияДляВыгрузки(Объект);
	Ошибки = ПроверитьДокументСВыводомВТаблицу_Форма2022_1(Объект, ДанныеУведомления, УникальныйИдентификатор);
	УведомлениеОСпецрежимахНалогообложения.СообщитьОшибкиПриПроверкеВыгрузки(Объект, Ошибки, ДанныеУведомления);
	ОсновныеСведения = ОсновныеСведенияЭлектронногоПредставления_Форма2022_1(Объект, УникальныйИдентификатор);
	СтруктураВыгрузки = Документы.УведомлениеОСпецрежимахНалогообложения.ИзвлечьСтруктуруXMLУведомления(Объект.ИмяОтчета, "СхемаВыгрузкиФорма2022_1");
	ЗаполнитьДанными_Форма2022_1(Объект, ОсновныеСведения, СтруктураВыгрузки);
	УведомлениеОСпецрежимахНалогообложения.ВыгрузитьДеревоВТаблицу(СтруктураВыгрузки, ОсновныеСведения, СведенияЭлектронногоПредставления);
	Возврат СведенияЭлектронногоПредставления;
КонецФункции

Функция ЭлектронноеПредставление_Форма2023_1(Объект, УникальныйИдентификатор)
	СведенияЭлектронногоПредставления = УведомлениеОСпецрежимахНалогообложения.СведенияЭлектронногоПредставления();
	ДанныеУведомления = УведомлениеОСпецрежимахНалогообложения.ДанныеУведомленияДляВыгрузки(Объект);
	Ошибки = ПроверитьДокументСВыводомВТаблицу_Форма2023_1(Объект, ДанныеУведомления, УникальныйИдентификатор);
	УведомлениеОСпецрежимахНалогообложения.СообщитьОшибкиПриПроверкеВыгрузки(Объект, Ошибки, ДанныеУведомления);
	ОсновныеСведения = ОсновныеСведенияЭлектронногоПредставления_Форма2022_1(Объект, УникальныйИдентификатор);
	СтруктураВыгрузки = Документы.УведомлениеОСпецрежимахНалогообложения.ИзвлечьСтруктуруXMLУведомления(Объект.ИмяОтчета, "СхемаВыгрузкиФорма2023_1");
	ЗаполнитьДанными_Форма2022_1(Объект, ОсновныеСведения, СтруктураВыгрузки);
	УведомлениеОСпецрежимахНалогообложения.ВыгрузитьДеревоВТаблицу(СтруктураВыгрузки, ОсновныеСведения, СведенияЭлектронногоПредставления);
	Возврат СведенияЭлектронногоПредставления;
КонецФункции

Процедура ЗаполнитьДанными_Форма2017_1(Объект, Параметры, ДеревоВыгрузки)
	Документы.УведомлениеОСпецрежимахНалогообложения.ОбработатьУсловныеЭлементы(Параметры, ДеревоВыгрузки);
	Документы.УведомлениеОСпецрежимахНалогообложения.ЗаполнитьПараметрыСРазделами(Параметры, ДеревоВыгрузки);
	ДанныеУведомления = Объект.ДанныеУведомления.Получить();
	УведомлениеОСпецрежимахНалогообложения.ЗаполнитьДаннымиУзелНов(ДанныеУведомления, ДеревоВыгрузки);
	ЗаполнитьМногострочнуюЧасть(ДанныеУведомления, ДеревоВыгрузки);
	Документы.УведомлениеОСпецрежимахНалогообложения.ОтсечьНезаполненныеНеобязательныеУзлы(ДеревоВыгрузки);
КонецПроцедуры

Процедура ЗаполнитьМногострочнуюЧасть(ДанныеУведомления, ДеревоВыгрузки)
	Узел_Документ = Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПодчиненныйЭлемент(ДеревоВыгрузки, "Документ");
	Узел_СоглНТОбщ = Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПодчиненныйЭлемент(Узел_Документ, "СоглНТОбщ");
	Узел_КодСвед = Документы.УведомлениеОСпецрежимахНалогообложения.ПолучитьПодчиненныйЭлемент(Узел_СоглНТОбщ, "КодСвед");
	Если Узел_КодСвед = Неопределено Тогда 
		Возврат;
	КонецЕсли;
	
	Для Каждого Стр Из ДанныеУведомления.ДанныеДопСтрокБД.МнгСтр Цикл
		Если ЗначениеЗаполнено(Стр.КодСвед) Тогда 
			НовУзел_КодСвед = Документы.УведомлениеОСпецрежимахНалогообложения.НовыйУзелИзПрототипа(Узел_КодСвед);
			Документы.УведомлениеОСпецрежимахНалогообложения.ВывестиПоказательВXML(НовУзел_КодСвед, Стр.КодСвед);
		КонецЕсли;
	КонецЦикла;
	РегламентированнаяОтчетность.УдалитьУзел(Узел_КодСвед);
КонецПроцедуры

Функция СформироватьСписокЛистовФорма2017_1(Объект) Экспорт
	Листы = Новый СписокЗначений;
	
	ПечатнаяФорма = УведомлениеОСпецрежимахНалогообложения.НовыйПустойЛист();
	СтруктураПараметров = ОбщегоНазначения.ЗначениеРеквизитаОбъекта(Объект.Ссылка, "ДанныеУведомления").Получить();
	ИННКПП = УведомлениеОСпецрежимахНалогообложения.ТиповаяСтруктураИННКППДляПечати(Объект, СтруктураПараметров.ДанныеУведомления.Титульная);
	
	НомСтр = 0;
	УведомлениеОСпецрежимахНалогообложения.НапечататьСтруктуру(Объект.ИмяОтчета, СтруктураПараметров.ДанныеУведомления["Титульная"],
		НомСтр, "Печать_Форма2017_1_Титульная", ПечатнаяФорма, ИННКПП);
	УведомлениеОСпецрежимахНалогообложения.ПоложитьПФВСписокЛистов(Объект, Листы, ПечатнаяФорма, НомСтр);
	
	УведомлениеОСпецрежимахНалогообложения.НапечататьСтруктуру(Объект.ИмяОтчета, СтруктураПараметров.ДанныеУведомления["Лист002"],
		НомСтр, "Печать_Форма2017_1_Лист002", ПечатнаяФорма, ИННКПП);
	Инд = 0;
	Для Каждого Стр Из СтруктураПараметров.ДанныеДопСтрокБД.МнгСтр Цикл
		Если ЗначениеЗаполнено(Стр.КодСвед) Тогда 
			Инд = Инд + 1;
			УведомлениеОСпецрежимахНалогообложения.ВывестиСтрокуНаПечать(ВРег(Стр.КодСвед), "КодСвед_" + Инд, ПечатнаяФорма.Области, "-");
		КонецЕсли;
		
		Если Инд = 96 Тогда 
			Прервать;
		КонецЕсли;
	КонецЦикла;
	
	Пока Инд < 96 Цикл 
		Инд = Инд + 1;
		УведомлениеОСпецрежимахНалогообложения.ВывестиСтрокуНаПечать("----", "КодСвед_" + Инд, ПечатнаяФорма.Области, "-");
	КонецЦикла;
	УведомлениеОСпецрежимахНалогообложения.ПоложитьПФВСписокЛистов(Объект, Листы, ПечатнаяФорма, НомСтр);
	
	Возврат Листы;
КонецФункции

Функция СформироватьСписокЛистовФорма2022_1(Объект) Экспорт
	Листы = Новый СписокЗначений;
	
	ПечатнаяФорма = УведомлениеОСпецрежимахНалогообложения.НовыйПустойЛист();
	СтруктураПараметров = ОбщегоНазначения.ЗначениеРеквизитаОбъекта(Объект.Ссылка, "ДанныеУведомления").Получить();
	ИННКПП = УведомлениеОСпецрежимахНалогообложения.ТиповаяСтруктураИННКППДляПечати(Объект, СтруктураПараметров.ДанныеУведомления.Титульная);
	ИННКПП.Вставить("НаимДок", СтруктураПараметров.ДанныеУведомления.Титульная.НаимДок);
	ИННКПП.Вставить("НаимДокПред", СтруктураПараметров.ДанныеУведомления.Титульная.НаимДокПред);
	ИННКПП.Вставить("КодНО", СтруктураПараметров.ДанныеУведомления.Титульная.КодНО);
	ИННКПП.Вставить("ПРИЗНАК_НП_ПОДВАЛ", СтруктураПараметров.ДанныеУведомления.Титульная.ПРИЗНАК_НП_ПОДВАЛ);
	ИННКПП.Вставить("НомСтр", 0);
	
	Титульная = СтруктураПараметров.ДанныеУведомления.Титульная;
	УведомлениеОСпецрежимахНалогообложения.РазбитьДатуДляПечатиВПрямоугольники(Титульная, "ДатаДок");
	УведомлениеОСпецрежимахНалогообложения.РазбитьДатуДляПечатиВПрямоугольники(Титульная, "ДатаНачСогл");
	УведомлениеОСпецрежимахНалогообложения.РазбитьДатуДляПечатиВПрямоугольники(Титульная, "ДатаКонСогл");
	УведомлениеОСпецрежимахНалогообложения.НапечататьДанные(Объект.ИмяОтчета,
		Титульная, "Печать_Форма2022_1_Титульная", ПечатнаяФорма, ИННКПП);
	УведомлениеОСпецрежимахНалогообложения.ПоложитьПФВСписокЛистов(Объект, Листы, ПечатнаяФорма, ИННКПП.НомСтр, Ложь);
	
	Лист001 = СтруктураПараметров.ДанныеУведомления.Лист001;
	Лист001Заполнен = УведомлениеОСпецрежимахНалогообложения.СтраницаЗаполнена(Лист001);
	Если Лист001Заполнен Тогда 
		СтруктураПечати = ОбщегоНазначения.СкопироватьРекурсивно(Лист001);
		СтруктураПечати.Вставить("НомСтр000", Формат((ИННКПП.НомСтр + 1), "ЧЦ=3; ЧВН="));
		Инд = -1;
		Для Каждого Стр Из СтруктураПараметров.ДанныеДопСтрокБД.МнгСтр1 Цикл
			Если ЗначениеЗаполнено(Стр.КодСвед) Тогда 
				Инд = ?(Инд = -1, 1, Инд + 1);
				СтруктураПечати.Вставить("КодСвед_" + Инд, Стр.КодСвед);
			КонецЕсли;
			Если Инд = 96 Тогда 
				УведомлениеОСпецрежимахНалогообложения.НапечататьДанные(Объект.ИмяОтчета,
					СтруктураПечати, "Печать_Форма2022_1_Лист001", ПечатнаяФорма, ИННКПП);
				УведомлениеОСпецрежимахНалогообложения.ПоложитьПФВСписокЛистов(Объект, Листы, ПечатнаяФорма, ИННКПП.НомСтр, Ложь);
				Инд = 0;
				СтруктураПечати = ОбщегоНазначения.СкопироватьРекурсивно(Лист001);
				СтруктураПечати.Вставить("НомСтр000", Формат((ИННКПП.НомСтр + 1), "ЧЦ=3; ЧВН="));
			КонецЕсли;
		КонецЦикла;
		Если Инд <> 0 Тогда 
			УведомлениеОСпецрежимахНалогообложения.НапечататьДанные(Объект.ИмяОтчета,
				СтруктураПечати, "Печать_Форма2022_1_Лист001", ПечатнаяФорма, ИННКПП);
			УведомлениеОСпецрежимахНалогообложения.ПоложитьПФВСписокЛистов(Объект, Листы, ПечатнаяФорма, ИННКПП.НомСтр, Ложь);
		КонецЕсли;
	КонецЕсли;
	Лист002 = СтруктураПараметров.ДанныеУведомления.Лист002;
	Лист002Заполнен = УведомлениеОСпецрежимахНалогообложения.СтраницаЗаполнена(Лист002);
	Если Лист002Заполнен Тогда 
		СтруктураПечати = ОбщегоНазначения.СкопироватьРекурсивно(Лист002);
		СтруктураПечати.Вставить("НомСтр000", Формат((ИННКПП.НомСтр + 1), "ЧЦ=3; ЧВН="));
		Если Не ЗначениеЗаполнено(СтруктураПечати.НаимОрг) Тогда 
			СтруктураПечати.НаимОрг = СокрЛП(СтруктураПечати.Фамилия + " " + СтруктураПечати.Имя + " " + СтруктураПечати.Отчество)
		КонецЕсли;
		Если Не ЗначениеЗаполнено(СтруктураПечати.ИННЮЛ) Тогда 
			СтруктураПечати.ИННЮЛ = СтруктураПечати.ИННФЛ;
		КонецЕсли;
		Инд = -1;
		Для Каждого Стр Из СтруктураПараметров.ДанныеДопСтрокБД.МнгСтр2 Цикл
			Если ЗначениеЗаполнено(Стр.КодСвед) Тогда 
				Инд = ?(Инд = -1, 1, Инд + 1);
				СтруктураПечати.Вставить("КодСвед_" + Инд, Стр.КодСвед);
			КонецЕсли;
			Если Инд = 96 Тогда 
				УведомлениеОСпецрежимахНалогообложения.НапечататьДанные(Объект.ИмяОтчета,
					СтруктураПечати, "Печать_Форма2022_1_Лист002", ПечатнаяФорма, ИННКПП);
				УведомлениеОСпецрежимахНалогообложения.ПоложитьПФВСписокЛистов(Объект, Листы, ПечатнаяФорма, ИННКПП.НомСтр, Ложь);
				Инд = 0;
				СтруктураПечати = ОбщегоНазначения.СкопироватьРекурсивно(Лист002);
				СтруктураПечати.Вставить("НомСтр000", Формат((ИННКПП.НомСтр + 1), "ЧЦ=3; ЧВН="));
			КонецЕсли;
		КонецЦикла;
		Если Инд <> 0 Тогда 
			УведомлениеОСпецрежимахНалогообложения.НапечататьДанные(Объект.ИмяОтчета,
				СтруктураПечати, "Печать_Форма2022_1_Лист002", ПечатнаяФорма, ИННКПП);
			УведомлениеОСпецрежимахНалогообложения.ПоложитьПФВСписокЛистов(Объект, Листы, ПечатнаяФорма, ИННКПП.НомСтр, Ложь);
		КонецЕсли;
	КонецЕсли;
	
	Возврат Листы;
КонецФункции

Функция СформироватьСписокЛистовФорма2023_1(Объект) Экспорт
	СписокИспользуемыхМакетов = УведомлениеОСпецрежимахНалогообложения.ЗагрузитьМакетыИзАрхива(Объект, "БланкиПечати_");
	Листы = Новый СписокЗначений;
	
	ПечатнаяФорма = УведомлениеОСпецрежимахНалогообложения.НовыйПустойЛист();
	СтруктураПараметров = ОбщегоНазначения.ЗначениеРеквизитаОбъекта(Объект.Ссылка, "ДанныеУведомления").Получить();
	ИННКПП = УведомлениеОСпецрежимахНалогообложения.ТиповаяСтруктураИННКППДляПечати(Объект, СтруктураПараметров.ДанныеУведомления.Титульная);
	
	НомСтр = 0;
	Титульная = СтруктураПараметров.ДанныеУведомления.Титульная;
	УведомлениеОСпецрежимахНалогообложения.НапечататьСтруктуру(Объект.ИмяОтчета, СтруктураПараметров.ДанныеУведомления["Титульная"], НомСтр,
		УведомлениеОСпецрежимахНалогообложения.ПустойМакетИзСписка(Объект, СписокИспользуемыхМакетов, "Печать_Форма2023_1_Титульная"), ПечатнаяФорма, ИННКПП);
	УведомлениеОСпецрежимахНалогообложения.ПоложитьПФВСписокЛистов(Объект, Листы, ПечатнаяФорма, НомСтр, Ложь);
	
	УведомлениеОСпецрежимахНалогообложения.НапечататьСтраницыСМногострочнойЧастью(Объект, Листы, СтруктураПараметров,
		"Лист001", "МнгСтр1", "Печать_Форма2023_1_Лист001", НомСтр, ИННКПП);
	Лист002 = СтруктураПараметров.ДанныеУведомления.Лист002;
	ИННКПП.Вставить("ИННЛист002", ?(ЗначениеЗаполнено(Лист002.ИННЮЛ), Лист002.ИННЮЛ, Лист002.ИННФЛ));
	ИННКПП.Вставить("НаимОргЛист002", ?(ЗначениеЗаполнено(Лист002.НаимОрг), Лист002.НаимОрг, 
		"" + Лист002.Фамилия + " " + Лист002.Имя + " " + Лист002.Отчество));
	УведомлениеОСпецрежимахНалогообложения.НапечататьСтраницыСМногострочнойЧастью(Объект, Листы, СтруктураПараметров,
		"Лист002", "МнгСтр2", "Печать_Форма2023_1_Лист002", НомСтр, ИННКПП);
	Возврат Листы;
КонецФункции

#КонецОбласти
#КонецЕсли
